<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surprise! ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap');

        :root { --rose: #e63946; --gold: #d4af37; }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Poppins', sans-serif;
            background: #ffe5ec; 
            background-size: cover; background-position: center;
            transition: background 1s ease-in-out;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
        }

        .container {
            width: 85%; max-width: 400px; text-align: center;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(10px);
            padding: 35px 20px; border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            z-index: 10; position: relative;
        }

        .hidden { display: none !important; }
        .script { font-family: 'Dancing Script', cursive; font-size: 2.8rem; color: var(--gold); }

        button {
            padding: 12px 25px; border: none; border-radius: 50px;
            cursor: pointer; font-weight: 600; margin: 10px;
            transition: 0.3s; font-family: 'Poppins', sans-serif;
        }

        .btn-yes { background: var(--rose); color: white; box-shadow: 0 4px 10px rgba(230,57,70,0.3); }
        .btn-no { background: #eee; color: #666; width: 100%; }

        /* Modal Pop-up */
        .modal {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.75); display: none;
            align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-content {
            background: white; padding: 30px; border-radius: 20px;
            width: 80%; max-width: 300px; text-align: center;
        }

        /* Progress & Flash */
        .prog-wrap { position: fixed; top:0; left:0; width:100%; height:6px; background: rgba(255,255,255,0.3); z-index: 500; }
        #prog-bar { height:100%; width:0%; background: var(--rose); transition: 0.5s; }
        #flash { position: fixed; top:0; left:0; width:100%; height:100%; background: white; opacity: 0; pointer-events: none; z-index: 2000; }

        /* Gallery */
        #gallery {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: white; overflow-y: auto; display: none;
            flex-direction: column; align-items: center; z-index: 1500; padding: 40px 0;
        }
        .pic { width: 85%; max-width: 350px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }

        .shake { animation: shake 0.2s infinite; }
        @keyframes shake { 0%,100% {transform: translateX(0);} 25% {transform: translateX(-10px);} 75% {transform: translateX(10px);} }
    </style>
</head>
<body id="bg">

    <div class="prog-wrap"><div id="prog-bar"></div></div>
    <div id="flash"></div>

    <div id="s1" class="container">
        <h1>I made a surprise for you, can you see it?</h1>
        <button class="btn-yes" onclick="toStep(2)">Yes</button>
        <button class="btn-no" onclick="howDareYou()">No</button>
    </div>

    <div id="s2" class="container hidden">
        <h1 class="script">He he he...</h1>
        <p>Click for surprise</p>
        <button class="btn-yes" onclick="showIntro()">Next</button>
    </div>

    <div id="s-intro" class="container hidden">
        <img src="intro.jpg" style="width:140px; height:140px; border-radius:50%; object-fit:cover; border:4px solid var(--gold); margin-bottom:10px;">
        <h1 class="script">Hey Handsome!</h1>
        <p id="type-txt"></p>
        <button id="start-btn" class="btn-yes hidden" onclick="startQuiz()">Get Started</button>
    </div>

    <div id="s-quiz" class="container hidden">
        <h2 id="q-text"></h2>
        <div id="ans-box"></div>
    </div>

    <div id="s-final" class="container hidden">
        <p id="type-last"></p>
        <div id="gift-box" class="hidden" style="font-size: 80px; cursor:pointer;" onclick="snap()">üéÅ</div>
    </div>

    <div id="gallery">
        <h2 class="script">Our Memories</h2>
        <img src="gallery1.jpg" class="pic">
        <img src="gallery2.jpg" class="pic">
        <img src="gallery3.jpg" class="pic">
        <img src="final.jpg" class="pic">
        <h1 class="script" style="font-size: 3rem; color: var(--rose);">I Love You</h1>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="m-msg"></p>
            <button class="btn-yes" onclick="closeM()">OK</button>
        </div>
    </div>

    <script>
        let step = 0;
        const bg = document.getElementById('bg');
        const urls = [
            'https://images.unsplash.com/photo-1518199266791-5375a83190b7?auto=format&fit=crop&w=1000',
            'https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?auto=format&fit=crop&w=1000',
            'https://images.unsplash.com/photo-1514395462725-fb4566210144?auto=format&fit=crop&w=1000',
            'https://images.unsplash.com/photo-1513694203232-719a280e022f?auto=format&fit=crop&w=1000',
            'https://images.unsplash.com/photo-1500673922987-e212871fec22?auto=format&fit=crop&w=1000'
        ];

        function toStep(n) {
            document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
            if(n === 2) { document.getElementById('s2').classList.remove('hidden'); confetti(); }
        }

        function howDareYou() {
            document.getElementById('s1').classList.add('shake');
            alertModal("HOW DARE YOU!");
            setTimeout(() => document.getElementById('s1').classList.remove('shake'), 1000);
        }

        function showIntro() {
            document.getElementById('s2').classList.add('hidden');
            document.getElementById('s-intro').classList.remove('hidden');
            typeOut("Let's play a little game. If you get these right, there's a surprise waiting.", "type-txt", () => {
                document.getElementById('start-btn').classList.remove('hidden');
            });
        }

        const questions = [
            { q: "The proposal date?", ops: ["Oct 7", "Oct 8", "Oct 9", "Oct 10"], ans: "Oct 9", msg: "Close call. You live to see another day." },
            { q: "Where was our first date?", ops: ["Movie", "Dinner", "Night street walking", "Coffee"], ans: "Night street walking", msg: "Simple, quiet, and perfect." },
            { q: "What's special in the number 207?", input: true, msg: "Correct. It was just our own little world. ‚ù§Ô∏è" },
            { q: "Destination on our bucket list?", ops: ["Munnar", "Ooty", "Goa", "Manali"], ans: "Ooty", msg: "Spot on! Can't wait for the mist." }
        ];

        function startQuiz() {
            document.getElementById('s-intro').classList.add('hidden');
            document.getElementById('s-quiz').classList.remove('hidden');
            loadQ();
        }

        function loadQ() {
            const q = questions[step];
            document.getElementById('prog-bar').style.width = ((step+1)*20) + "%";
            bg.style.backgroundImage = `url('${urls[step+1]}')`;
            document.getElementById('q-text').innerText = q.q;
            const box = document.getElementById('ans-box');
            box.innerHTML = "";

            if(q.input) {
                const i = document.createElement('input');
                i.style = "width:100%; padding:10px; border-radius:10px; border:2px solid #ccc; box-sizing:border-box;";
                i.id = "user-in"; i.placeholder = "Type answer...";
                const b = document.createElement('button');
                b.className = "btn-yes"; b.innerText = "Submit";
                b.onclick = () => check(document.getElementById('user-in').value.toLowerCase().trim());
                box.appendChild(i); box.appendChild(b);
            } else {
                q.ops.forEach(o => {
                    const b = document.createElement('button');
                    b.innerText = o; b.className = "btn-no";
                    b.onclick = () => check(o);
                    box.appendChild(b);
                });
            }
        }

        function check(val) {
            const q = questions[step];
            let right = false;
            if(q.input) {
                // Smart check for room, park, or avenue
                if(val.includes("room") || val.includes("park") || val.includes("avenue")) right = true;
            } else {
                if(val === q.ans) right = true;
            }

            if(right) {
                confetti();
                alertModal(q.msg, () => {
                    step++;
                    if(step < questions.length) loadQ();
                    else showVal();
                });
            } else {
                alertModal("Wrong! Try again.");
            }
        }

        function showVal() {
            bg.style.backgroundImage = `url('${urls[0]}')`;
            document.getElementById('s-quiz').innerHTML = `
                <h1 class="script">Will you be my valentine?</h1>
                <button class="btn-yes" onclick="valYes()">Yes</button>
                <button class="btn-no" id="no-btn" onmouseover="flee()">No</button>
            `;
        }

        function flee() {
            const b = document.getElementById('no-btn');
            b.style.position = "fixed";
            b.style.left = Math.random() * 70 + 10 + "vw";
            b.style.top = Math.random() * 70 + 10 + "vh";
        }

        function valYes() {
            confetti({particleCount: 200});
            document.getElementById('s-quiz').classList.add('hidden');
            document.getElementById('s-final').classList.remove('hidden');
            typeOut("I‚Äôm glad we‚Äôre on the same page. Thanks for being my person and for dealing with my mood swings. Happy Valentine's Day, favorite. üåπ", "type-last", () => {
                document.getElementById('gift-box').classList.remove('hidden');
            });
        }

        function snap() {
            document.getElementById('flash').style.opacity = 1;
            setTimeout(() => {
                document.getElementById('flash').style.opacity = 0;
                document.getElementById('s-final').classList.add('hidden');
                document.getElementById('gallery').style.display = "flex";
                document.body.style.overflow = "auto";
            }, 300);
        }

        function alertModal(m, cb) {
            document.getElementById('m-msg').innerHTML = m;
            document.getElementById('modal').style.display = "flex";
            window.mCb = cb;
        }

        function closeM() {
            document.getElementById('modal').style.display = "none";
            if(window.mCb) window.mCb();
        }

        function typeOut(t, id, cb) {
            let i = 0; const el = document.getElementById(id); el.innerText = "";
            const timer = setInterval(() => {
                if(i < t.length) { el.innerText += t.charAt(i); i++; }
                else { clearInterval(timer); if(cb) cb(); }
            }, 40);
        }
    </script>
</body>
</html>

