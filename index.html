<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Surprise For You ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap');

        :root {
            --rose: #e63946;
            --gold: #d4af37;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Poppins', sans-serif;
            background-color: #ffe5ec;
            background-size: cover;
            background-position: center;
            transition: background-image 1.2s ease-in-out;
            overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }

        .hidden { display: none !important; }

        /* Card Design */
        .container {
            width: 85%; max-width: 400px; text-align: center;
            background: rgba(255, 255, 255, 0.82);
            backdrop-filter: blur(15px);
            padding: 40px 25px; border-radius: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            position: relative; z-index: 10;
            border: 1px solid rgba(255,255,255,0.4);
            animation: bounceIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes bounceIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        h1, h2 { color: #333; font-weight: 600; font-size: 1.3rem; }
        .script { font-family: 'Dancing Script', cursive; font-size: 3rem; color: var(--gold); text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }

        button {
            padding: 14px 28px; border: none; border-radius: 50px;
            cursor: pointer; font-weight: 600; transition: all 0.3s ease;
            margin: 10px; font-family: 'Poppins', sans-serif;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-yes { background: var(--rose); color: white; }
        .btn-no { background: #f0f0f0; color: #888; }
        .btn-yes:hover { transform: scale(1.1); background: #d0303d; }

        /* Custom Animations */
        .shake { animation: shakeEffect 0.15s infinite; }
        @keyframes shakeEffect {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shatter { animation: shatterAnim 0.8s ease forwards; }
        @keyframes shatterAnim {
            to { transform: scale(1.5); opacity: 0; filter: blur(15px); }
        }

        /* Progress Bar */
        .progress-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 8px; background: rgba(255,255,255,0.3); z-index: 2000;
        }
        #progress-bar { width: 0%; height: 100%; background: var(--rose); transition: width 0.6s ease; }

        /* Quiz UI */
        .option-btn { width: 100%; margin: 10px 0; background: white; border: 2px solid #ffccd5; color: #444; }
        .option-btn:hover { background: #ffe5ec; border-color: var(--rose); transform: translateY(-3px); }

        /* Modal Pop-up */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
            display: flex; align-items: center; justify-content: center; z-index: 5000;
            opacity: 0; pointer-events: none; transition: opacity 0.4s;
        }
        .modal.show { opacity: 1; pointer-events: auto; }
        .modal-content {
            background: white; padding: 35px; border-radius: 25px; width: 85%; max-width: 320px; text-align: center;
        }

        /* Floating Hearts Background */
        .heart-bg { position: fixed; color: rgba(230, 57, 70, 0.3); font-size: 20px; pointer-events: none; z-index: 1; animation: floatUp 4s linear infinite; }
        @keyframes floatUp {
            0% { transform: translateY(110vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }

        /* Final Scroll */
        #gallery-scroll {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; overflow-y: auto; display: flex; flex-direction: column; align-items: center; padding: 60px 0; z-index: 4000;
        }
        .scroll-img { width: 85%; max-width: 380px; border-radius: 20px; margin-bottom: 40px; 
                      box-shadow: 0 15px 35px rgba(0,0,0,0.15); opacity: 0; transform: translateX(-50px); transition: all 1s ease; }
        .scroll-img.visible { opacity: 1; transform: translateX(0); }

        #flash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; pointer-events: none; z-index: 6000; }
        .gift-box { font-size: 110px; cursor: pointer; animation: pulse 1.5s infinite; display: inline-block; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.15); } 100% { transform: scale(1); } }
    </style>
</head>
<body id="main-body">

    <div class="progress-container"><div id="progress-bar"></div></div>
    <div id="flash"></div>

    <div id="step1" class="container">
        <h1>I made a surprise for you, can you see it?</h1>
        <button class="btn-yes" onclick="celebrate(); setTimeout(() => nextStep(2), 800)">Yes</button>
        <button class="btn-no" onclick="triggerHowDareYou()">No</button>
    </div>

    <div id="step2" class="container hidden">
        <h1 style="animation: bounce 1s infinite;">He he he... click for surprise</h1>
        <button class="btn-yes" onclick="shatterTransition()">Next</button>
    </div>

    <div id="step2-greeting" class="container hidden">
        <img src="intro.jpg" style="width:160px; height:160px; border-radius:50%; border:5px solid var(--gold); object-fit:cover; margin-bottom:15px;">
        <h1 class="script">Hey Handsome!</h1>
        <p id="greet-text"></p>
        <button id="get-started" class="btn-yes hidden" onclick="startQuiz()">Get Started</button>
    </div>

    <div id="quiz-container" class="container hidden">
        <h2 id="question-text"></h2>
        <div id="options-area"></div>
    </div>

    <div id="finale-msg" class="container hidden">
        <p id="type-final" style="font-weight: 400; line-height: 1.8;"></p>
        <div id="gift-section" class="hidden">
            <div class="gift-box" onclick="cameraShutter()">üéÅ</div>
            <p style="font-size: 0.9rem; color: #888;">Tap the gift box</p>
        </div>
    </div>

    <div id="gallery-scroll" class="hidden">
        <h2 class="script">Our Memories</h2>
        <img src="gallery1.jpg" class="scroll-img">
        <img src="gallery2.jpg" class="scroll-img">
        <img src="gallery3.jpg" class="scroll-img">
        <img src="final.jpg" class="scroll-img">
        <div class="script" style="font-size: 3.5rem; color: var(--rose); margin: 60px 0;">I love you</div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="modal-msg"></p>
            <button class="btn-yes" onclick="closeModal()">OK</button>
        </div>
    </div>

    <script>
        const body = document.getElementById('main-body');
        const backgrounds = {
            intro: 'https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=2070&auto=format&fit=crop', // Romantic pink petals
            q1: 'https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070&auto=format&fit=crop', // Proposal vibe
            q2: 'https://images.unsplash.com/photo-1514395462725-fb4566210144?q=80&w=2071&auto=format&fit=crop', // Night city street
            q3: 'https://images.unsplash.com/photo-1513694203232-719a280e022f?q=80&w=2069&auto=format&fit=crop', // Cozy aesthetic room
            q4: 'https://images.unsplash.com/photo-1500673922987-e212871fec22?q=80&w=2070&auto=format&fit=crop', // Misty mountains
            finale: 'https://images.unsplash.com/photo-1516589174184-c685265162fb?q=80&w=1974&auto=format&fit=crop' // Hearts bokeh
        };

        body.style.backgroundImage = `url('${backgrounds.intro}')`;

        function nextStep(step) {
            document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
            if(step === 2) document.getElementById('step2').classList.remove('hidden');
        }

        function triggerHowDareYou() {
            const currentContainer = document.querySelector('.container:not(.hidden)');
            currentContainer.classList.add('shake');
            showModal("<span style='color:red; font-weight:bold;'>HOW DARE YOU!</span>", () => {
                currentContainer.classList.remove('shake');
            });
        }

        function shatterTransition() {
            const s2 = document.getElementById('step2');
            s2.classList.add('shatter');
            setTimeout(() => {
                s2.classList.add('hidden');
                document.getElementById('step2-greeting').classList.remove('hidden');
                typeWriter("Let's play a little game. If you get these right, there's a surprise waiting.", "greet-text", () => {
                    document.getElementById('get-started').classList.remove('hidden');
                });
            }, 700);
        }

        function typeWriter(text, id, cb, speed = 40) {
            let i = 0; const el = document.getElementById(id); el.innerHTML = "";
            function type() { if(i < text.length) { el.innerHTML += text.charAt(i); i++; setTimeout(type, speed); } else if(cb) cb(); }
            type();
        }

        const questions = [
            { q: "The proposal date?", ops: ["Oct 7", "Oct 8", "Oct 9", "Oct 10"], ans: "Oct 9", bg: backgrounds.q1,
              wrong: (c) => c === "Oct 10" ? "Are you serious right now? One day off is still WRONG. Do better." : "Seriously? You‚Äôre lucky I don‚Äôt revoke the 'Yes' right now. Try again.",
              right: "Close call. You live to see another day. That day changed everything." },
            { q: "Where was our first date?", ops: ["Movie night", "Dinner date", "Night street walking", "Coffee shop"], ans: "Night street walking", bg: backgrounds.q2,
              wrong: () => "Incorrect! It's like you weren't even there. Try again!",
              right: "Simple, quiet, and perfect. Better than any fancy dinner." },
            { q: "What's special in the number 207?", input: true, bg: backgrounds.q3,
              ans: ["room", "park avenue", "park avenue room"], 
              wrong: () => "Nope. Think harder. It‚Äôs a place we‚Äôll never forget!",
              right: "Correct. It was just our own little world for a while. I still think about it. ‚ù§Ô∏è" },
            { q: "The destination in our bucket list?", ops: ["Munnar", "Ooty", "Goa", "Manali"], ans: "Ooty", bg: backgrounds.q4,
              wrong: () => "In your dreams! That's not where we're going. Try again.",
              right: "Spot on. Can't wait for the mist, the coffee, and us finally being there." }
        ];

        function startQuiz() {
            document.getElementById('step2-greeting').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQ];
            document.getElementById('progress-bar').style.width = ((currentQ + 1) * 20) + "%";
            body.style.backgroundImage = `url('${q.bg}')`;
            document.getElementById('question-text').innerText = q.q;
            const area = document.getElementById('options-area');
            area.innerHTML = "";

            if(q.input) {
                const input = document.createElement('input');
                input.style = "width:100%; padding:15px; border-radius:15px; border:2px solid #ddd; margin-bottom:15px; box-sizing:border-box; font-family:inherit;";
                input.placeholder = "Type your answer...";
                const btn = document.createElement('button');
                btn.className = "btn-yes"; btn.innerText = "Submit";
                btn.onclick = () => checkAnswer(input.value.toLowerCase().trim());
                area.appendChild(input); area.appendChild(btn);
            } else {
                q.ops.forEach(opt => {
                    const b = document.createElement('button');
                    b.className = "option-btn"; b.innerText = opt;
                    b.onclick = () => checkAnswer(opt);
                    area.appendChild(b);
                });
            }
        }

        function checkAnswer(val) {
            const q = questions[currentQ];
            const isRight = q.input ? (val.includes("room") || val.includes("park avenue") || val.includes("park avenue room")) : (val === q.ans);
            
            if(isRight) {
                celebrate();
                showModal(q.right, () => {
                    currentQ++;
                    if(currentQ < questions.length) loadQuestion();
                    else showValentineQuestion();
                });
            } else {
                showModal(q.input ? q.wrong() : q.wrong(val));
            }
        }

        function showValentineQuestion() {
            body.style.backgroundImage = `url('${backgrounds.finale}')`;
            const area = document.getElementById('quiz-container');
            area.innerHTML = `
                <h1 class="script" style="font-size: 2rem;">Will you be my valentine?</h1>
                <button class="btn-yes" onclick="valentineYes()">Yes</button>
                <button class="btn-no" id="flee-no" onmouseover="flee()" onclick="valentineTrap()">No</button>
            `;
        }

        function flee() {
            const b = document.getElementById('flee-no');
            b.style.position = "fixed";
            b.style.left = Math.random() * 70 + 15 + "vw";
            b.style.top = Math.random() * 70 + 15 + "vh";
        }

        function valentineTrap() {
            showModal("Nice try! Error 404, you are mine and you are being my valentine I'm not asking, i am telling click the other button.");
        }

        function valentineYes() {
            celebrate();
            showModal("The only correct answer! I knew you'd make the right choice. üòâ", () => {
                document.getElementById('quiz-container').classList.add('hidden');
                document.getElementById('finale-msg').classList.remove('hidden');
                typeWriter("I‚Äôm glad we‚Äôre on the same page. Thanks for being my person and for dealing with my mood swings. Looking forward to Ooty, 207, and everything else we have planned. Happy Valentine's Day, favorite. üåπü´Çüë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë®", "type-final", () => {
                    document.getElementById('gift-section').classList.remove('hidden');
                }, 25);
            });
        }

        function cameraShutter() {
            const flash = document.getElementById('flash');
            flash.style.opacity = '1';
            setTimeout(() => {
                flash.style.opacity = '0';
                document.getElementById('finale-msg').classList.add('hidden');
                document.getElementById('gallery-scroll').classList.remove('hidden');
                document.body.style.overflow = 'auto';
                initScrollReveal();
            }, 300);
        }

        function showModal(msg, cb) {
            document.getElementById('modal-msg').innerHTML = msg;
            document.getElementById('modal').classList.add('show');
            window.modalCb = cb;
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('show');
            if(window.modalCb) window.modalCb();
        }

        function celebrate() {
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#ff0a54', '#ff477e', '#ff7096', '#fbb1bd'] });
        }

        function initScrollReveal() {
            const imgs = document.querySelectorAll('.scroll-img');
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => { if(entry.isIntersecting) entry.target.classList.add('visible'); });
            }, { threshold: 0.1 });
            imgs.forEach(i => observer.observe(i));
        }

        setInterval(() => {
            const h = document.createElement('div'); h.innerHTML = '‚ù§Ô∏è'; h.className = 'heart-bg';
            h.style.left = Math.random() * 100 + 'vw'; h.style.fontSize = Math.random() * 20 + 10 + 'px';
            document.body.appendChild(h); setTimeout(() => h.remove(), 4000);
        }, 600);
    </script>
</body>
</html>

