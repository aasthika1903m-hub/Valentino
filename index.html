<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine's Challenge ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --primary: #ff4d6d; --bg: #fff0f3; }
        body { background: linear-gradient(135deg, #ffafbd 0%, #ffc3a0 100%); font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        #quiz-container { background: rgba(255, 255, 255, 0.95); padding: 2.5rem; border-radius: 30px; box-shadow: 0 25px 50px rgba(0,0,0,0.15); max-width: 400px; width: 85%; text-align: center; z-index: 10; border: 2px solid white; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px 25px; margin: 8px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .btn:hover { transform: scale(1.05); }
        input[type="text"] { padding: 12px; width: 80%; border: 2px solid #ffccd5; border-radius: 12px; margin-bottom: 10px; text-align: center; }
        /* Pop-up Overlay */
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); display: none; z-index: 99; }
        #popup-note { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 100; transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 3px solid var(--primary); text-align: center; width: 75%; }
        #popup-note.show { transform: translate(-50%, -50%) scale(1); }
        .hidden { display: none; }
        .floating-heart { position: absolute; bottom: -50px; color: var(--primary); animation: float-up 4s linear forwards; }
        @keyframes float-up { to { transform: translateY(-110vh) rotate(360deg); opacity: 0; } }
        #final-msg { font-style: italic; font-weight: 600; color: #444; min-height: 80px; line-height: 1.5; }
    </style>
</head>
<body onclick="hidePopup()">
    <div id="overlay"></div>
    <div id="popup-note"></div>

    <div id="quiz-container" onclick="event.stopPropagation()">
        <div id="intro-screen">
            <h2>Hey Handsome! ‚ù§Ô∏è</h2>
            <p>Think you know us? Prove it. 5 questions stand between you and your message.</p>
            <button class="btn" onclick="startQuiz()">Start Challenge</button>
        </div>
        <div id="question-box" class="hidden">
            <h2 id="question-text"></h2>
            <div id="options-container"></div>
        </div>
        <div id="final-screen" class="hidden">
            <h2 style="animation: heartbeat 1.2s infinite;">Happy Valentine's Day!</h2>
            <p id="final-msg"></p>
            <div id="final-emojis" style="font-size: 2.5rem; margin-top: 15px;"></div>
        </div>
    </div>

<script>
    const questions = [
        { q: "The proposal date?", options: ["Oct 7", "Oct 8", "Oct 9", "Oct 10"], answer: "Oct 8", wrong: (c) => c === "Oct 9" ? "Are you serious? One day off is still WRONG." : "Nope! Try again.", right: "Close call! You live to see another day. ‚ù§Ô∏è (Tap to continue)" },
        { q: "Our first date?", options: ["Movie night", "Dinner date", "Night street walking", "Coffee shop"], answer: "Night street walking", wrong: () => "Incorrect! It's like you weren't even there!", right: "Simple and perfect. ‚ú® (Tap to continue)" },
        { q: "What's special in the number 207?", type: "input", answer: "207", wrong: () => "Nope. Think harder. It‚Äôs a place we‚Äôll never forget!", right: "Correct. Our own little world. üè† (Tap to continue)" },
        { q: "The destination in our bucket list?", options: ["Munnar", "Ooty", "Goa", "Manali"], answer: "Ooty", wrong: () => "In your dreams! That's not where we're going.", right: "Spot on! Ooty it is. ‚òï (Tap to continue)" },
        { q: "Will you be my valentine?", options: ["Yes", "No"], answer: "Yes", wrong: () => "Nice try! Error 404: You are mine. Click the other button! üò§", right: "The only correct answer! üòâ (Tap to continue)" }
    ];

    let currentIdx = 0;
    let isCorrect = false;

    function showPopup(text, isError) {
        const p = document.getElementById('popup-note');
        const ov = document.getElementById('overlay');
        p.innerText = text;
        p.style.borderColor = isError ? "#c9184a" : "#2d6a4f";
        p.classList.add('show');
        ov.style.display = 'block';
        isCorrect = !isError;
    }

    function hidePopup() {
        const p = document.getElementById('popup-note');
        const ov = document.getElementById('overlay');
        if (p.classList.contains('show')) {
            p.classList.remove('show');
            ov.style.display = 'none';
            if (isCorrect) next();
        }
    }

    function startQuiz() { document.getElementById('intro-screen').classList.add('hidden'); document.getElementById('question-box').classList.remove('hidden'); loadQuestion(); }

    function loadQuestion() {
        const qText = document.getElementById('question-text'); const optBox = document.getElementById('options-container'); const current = questions[currentIdx];
        qText.innerText = current.q; optBox.innerHTML = '';
        if (current.type === "input") {
            const input = document.createElement('input'); input.type = 'text'; input.id = 'ans'; input.placeholder = "Type here...";
            const b = document.createElement('button'); b.innerText = 'Submit'; b.className = 'btn';
            b.onclick = (e) => { e.stopPropagation(); if(document.getElementById('ans').value.includes('207')) { showPopup(current.right, false); confetti(); } else { showPopup(current.wrong(), true); } };
            optBox.append(input, b);
        } else {
            current.options.forEach(opt => {
                const b = document.createElement('button'); b.innerText = opt; b.className = 'btn';
                b.onclick = (e) => { e.stopPropagation(); if(opt === current.answer) { showPopup(current.right, false); confetti(); } else { showPopup(current.wrong(opt), true); } };
                optBox.appendChild(b);
            });
        }
    }

    function next() { currentIdx++; if(currentIdx < questions.length) loadQuestion(); else showFinal(); }

    function showFinal() {
        document.getElementById('question-box').classList.add('hidden'); document.getElementById('final-screen').classList.remove('hidden');
        const msg = "I‚Äôm glad we‚Äôre on the same page. Thanks for being my person and for dealing with my mood swings. Looking forward to Ooty, 207, and everything else we have planned. Happy Valentine's Day, favorite.";
        let i = 0; 
        function type() { 
            if(i < msg.length) { 
                document.getElementById('final-msg').innerHTML += msg.charAt(i); 
                i++; 
                setTimeout(type, 35); // Speed increased from 50 to 35
            } else {
                document.getElementById('final-emojis').innerHTML = "üåπü´Çüë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë®";
            }
        }
        type(); 
        setInterval(() => { const h = document.createElement('div'); h.className = 'floating-heart'; h.innerHTML = '‚ù§Ô∏è'; h.style.left = Math.random()*100+'vw'; document.body.appendChild(h); setTimeout(()=>h.remove(),4000); }, 300);
    }
</script>
</body>
</html>
