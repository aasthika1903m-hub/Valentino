<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Surprise For You ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap');

        :root {
            --rose: #e63946;
            --gold: #d4af37;
            --bg-1: linear-gradient(135deg, #ffe5ec 0%, #fff0f3 100%);
            --bg-2: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
            --bg-3: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
            --bg-4: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-5: linear-gradient(135deg, #a8e063 0%, #56ab2f 100%);
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Poppins', sans-serif;
            background: var(--bg-1);
            transition: background 1.5s ease;
            overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }

        .hidden { display: none !important; }

        .container {
            width: 85%; max-width: 400px; text-align: center;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            padding: 40px 25px; border-radius: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            position: relative; z-index: 10;
            border: 1px solid rgba(255,255,255,0.3);
        }

        h1, h2 { color: #444; font-weight: 600; }
        .script { font-family: 'Dancing Script', cursive; font-size: 2.8rem; color: var(--gold); }

        button {
            padding: 14px 30px; border: none; border-radius: 50px;
            cursor: pointer; font-weight: 600; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            margin: 10px; font-family: 'Poppins', sans-serif;
        }

        .btn-yes { background: var(--rose); color: white; box-shadow: 0 4px 15px rgba(230,57,70,0.3); }
        .btn-no { background: #f0f0f0; color: #888; }
        .btn-yes:hover { transform: scale(1.1); background: #d0303d; }

        /* Animations */
        .fade-in { animation: fadeInUp 0.8s ease forwards; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .shake { animation: highFreqShake 0.15s infinite; }
        @keyframes highFreqShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Progress Bar */
        .progress-container { position: fixed; top: 0; left: 0; width: 100%; height: 8px; background: rgba(255,255,255,0.3); z-index: 2000; }
        #progress-bar { width: 0%; height: 100%; background: var(--rose); transition: width 0.6s ease; }

        /* Option B Message Box */
        .message-box { min-height: 150px; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; line-height: 1.6; color: #444; margin-bottom: 20px; }
        
        /* Modal Pop-up */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
            display: flex; align-items: center; justify-content: center; z-index: 5000;
            opacity: 0; pointer-events: none; transition: opacity 0.4s;
        }
        .modal.show { opacity: 1; pointer-events: auto; }
        .modal-content {
            background: white; padding: 35px; border-radius: 25px; width: 85%; max-width: 320px; text-align: center;
            transform: scale(0.8); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal.show .modal-content { transform: scale(1); }

        /* Floating Hearts */
        .heart { position: fixed; color: rgba(230, 57, 70, 0.3); font-size: 20px; pointer-events: none; z-index: 1; animation: floatHeart 4s linear infinite; }
        @keyframes floatHeart {
            0% { transform: translateY(110vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }

        .big-heart { font-size: 80px; cursor: pointer; display: inline-block; animation: heartbeat 1.5s infinite; filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.4)); }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
    </style>
</head>
<body>

    <div class="progress-container"><div id="progress-bar"></div></div>

    <div id="step1" class="container fade-in">
        <h1>I made a surprise for you, can you see it?</h1>
        <button class="btn-yes" onclick="heartExplosion(); nextStep(2)">Yes</button>
        <button class="btn-no" onclick="triggerHowDareYou()">No</button>
    </div>

    <div id="step2" class="container hidden">
        <h1 class="script">He he he...</h1>
        <p>Click for surprise</p>
        <button class="btn-yes" onclick="showGreeting()">Next</button>
    </div>

    <div id="step-greet" class="container hidden">
        <h1 class="script">Hey Handsome!</h1>
        <p id="greet-text"></p>
        <button id="get-started" class="btn-yes hidden" onclick="startQuiz()">Get Started</button>
    </div>

    <div id="quiz-container" class="container hidden">
        <h2 id="question-text"></h2>
        <div id="options-area"></div>
    </div>

    <div id="finale-messages" class="container hidden">
        <div id="heart-trigger" class="big-heart" onclick="showNextMessage()">‚ù§Ô∏è</div>
        <div class="message-box" id="personal-note">Tap the heart to read my feelings...</div>
        <button id="next-note-btn" class="btn-yes hidden" onclick="showNextMessage()">Read Next</button>
    </div>

    <div id="the-end" class="container hidden">
        <h1 class="script" style="font-size: 3.5rem;">Thank you.<br>I love you.</h1>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="modal-msg" style="font-weight: 600;"></p>
            <button class="btn-yes" onclick="closeModal()">OK</button>
        </div>
    </div>

    <script>
        let currentQ = 0;
        let currentNote = 0;

        const questions = [
            { q: "The proposal date?", ops: ["Oct 7", "Oct 8", "Oct 9", "Oct 10"], ans: "Oct 8", 
              right: "Close call. You live to see another day. That day changed everything.", bg: 'var(--bg-2)' },
            { q: "Where was our first date?", ops: ["Movie night", "Dinner date", "Night street walking", "Coffee shop"], ans: "Night street walking",
              right: "Simple, quiet, and perfect. Better than any fancy dinner.", bg: 'var(--bg-3)' },
            { q: "What's special in the number 207?", input: true, ans: ["room", "park avenue", "park avenue room"],
              right: "Correct. It was just our own little world for a while. ‚ù§Ô∏è", bg: 'var(--bg-4)' },
            { q: "The destination in our bucket list?", ops: ["Munnar", "Ooty", "Goa", "Manali"], ans: "Ooty",
              right: "Spot on. Can't wait for the mist and us finally being there.", bg: 'var(--bg-5)' }
        ];

        const notes = [
            "You‚Äôre literally my safe spot. Whenever I‚Äôm stressed or overthinking, you just know how to make everything quiet again.",
            "And okay, I‚Äôll finally admit it‚ÄîI actually love it when you tease me. I might act annoyed, but it‚Äôs honestly my favorite part of us.",
            "When we‚Äôre on call and I hear you laugh, it‚Äôs the best feeling in the world. It makes me feel so good knowing I‚Äôm the one making you happy.",
            "The biggest thing? Thank you for staying. I know I make mistakes and I lose hope sometimes, but you never walked away. You stayed when things were hard, and that means everything to me.",
            "I‚Äôm so, so proud of how hard you work and how much you‚Äôre growing. Thank you for making me a part of your life."
        ];

        function nextStep(s) {
            document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
            if(s === 2) document.getElementById('step2').classList.remove('hidden');
        }

        function triggerHowDareYou() {
            const c = document.getElementById('step1');
            c.classList.add('shake');
            showModal("<span style='color:red;'>HOW DARE YOU!</span>", () => c.classList.remove('shake'));
        }

        function showGreeting() {
            nextStep(0);
            document.getElementById('step-greet').classList.remove('hidden');
            document.body.style.background = 'var(--bg-3)';
            typeWriter("Let's play a little game. If you get these right, there's a surprise waiting.", "greet-text", () => {
                document.getElementById('get-started').classList.remove('hidden');
            });
        }

        function startQuiz() {
            document.getElementById('step-greet').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQ];
            document.getElementById('progress-bar').style.width = ((currentQ + 1) * 25) + "%";
            document.body.style.background = q.bg;
            document.getElementById('question-text').innerText = q.q;
            const area = document.getElementById('options-area');
            area.innerHTML = "";

            if(q.input) {
                const i = document.createElement('input');
                i.style = "width:100%; padding:15px; border-radius:15px; border:2px solid #ddd; margin-bottom:15px; box-sizing:border-box;";
                i.placeholder = "Type here..."; i.id = "user-in";
                const b = document.createElement('button');
                b.className = "btn-yes"; b.innerText = "Submit";
                b.onclick = () => checkAnswer(document.getElementById('user-in').value.toLowerCase().trim());
                area.appendChild(i); area.appendChild(b);
            } else {
                q.ops.forEach(opt => {
                    const b = document.createElement('button');
                    b.style = "width:100%; margin: 10px 0; background:white; border:2px solid #ffccd5;";
                    b.innerText = opt; b.onclick = () => checkAnswer(opt);
                    area.appendChild(b);
                });
            }
        }

        function checkAnswer(val) {
            const q = questions[currentQ];
            const isRight = q.input ? q.ans.includes(val) : (val === q.ans);
            if(isRight) {
                heartExplosion();
                showModal(q.right, () => {
                    currentQ++;
                    if(currentQ < questions.length) loadQuestion();
                    else showValentineQ();
                });
            } else {
                showModal("Wrong answer! Think harder...");
            }
        }

        function showValentineQ() {
            document.body.style.background = 'var(--bg-1)';
            const area = document.getElementById('quiz-container');
            area.innerHTML = `
                <h1 class="script">Will you be my valentine?</h1>
                <button class="btn-yes" onclick="valentineYes()">Yes</button>
                <button class="btn-no" id="flee-no" onmouseover="flee()">No</button>
            `;
        }

        function flee() {
            const b = document.getElementById('flee-no');
            b.style.position = "fixed";
            b.style.left = Math.random() * 80 + 10 + "vw";
            b.style.top = Math.random() * 80 + 10 + "vh";
        }

        function valentineYes() {
            heartExplosion();
            showModal("The only correct answer! üòâ", () => {
                document.getElementById('quiz-container').classList.add('hidden');
                document.getElementById('finale-messages').classList.remove('hidden');
            });
        }

        function showNextMessage() {
            if(currentNote < notes.length) {
                document.getElementById('heart-trigger').classList.add('hidden');
                document.getElementById('next-note-btn').classList.add('hidden');
                typeWriter(notes[currentNote], "personal-note", () => {
                    currentNote++;
                    document.getElementById('next-note-btn').classList.remove('hidden');
                    if(currentNote === notes.length) {
                        document.getElementById('next-note-btn').innerText = "Last One ‚ù§Ô∏è";
                    }
                });
            } else {
                finalSymmetry();
            }
        }

        function finalSymmetry() {
            document.getElementById('finale-messages').classList.add('hidden');
            document.getElementById('the-end').classList.remove('hidden');
            confetti({ particleCount: 400, spread: 100, origin: { y: 0.6 } });
        }

        function typeWriter(text, elementId, callback) {
            let i = 0; const el = document.getElementById(elementId);
            el.innerHTML = "";
            function type() {
                if (i < text.length) {
                    el.innerHTML += text.charAt(i); i++;
                    setTimeout(type, 30);
                } else if(callback) callback();
            }
            type();
        }

        function showModal(msg, cb) {
            document.getElementById('modal-msg').innerHTML = msg;
            document.getElementById('modal').classList.add('show');
            window.modalCb = cb;
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('show');
            if(window.modalCb) window.modalCb();
        }

        function heartExplosion() {
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: ['#ff0a54', '#ff477e', '#ff7096'] });
        }

        setInterval(() => {
            const h = document.createElement('div'); h.innerHTML = '‚ù§Ô∏è'; h.className = 'heart';
            h.style.left = Math.random() * 100 + 'vw'; h.style.animationDuration = (Math.random()*2+3)+'s';
            document.body.appendChild(h); setTimeout(()=>h.remove(), 5000);
        }, 600);
    </script>
</body>
</html>
